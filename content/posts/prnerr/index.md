+++
date = '2025-01-17T16:22:19+02:00'
draft = false
hidden = false
title = 'Поправка на грешка 0x00000709 при свързване към споделен принтер в Windows 11'
coverImg = 'cover.png'
tags = ['0x00000709','printers','sharing','shared printers','споделени принтери','принтери','грешка','грешки']
summary = 'Остраняване на проблем при свързване от Windows 11 към споделен принтер с Windows 10.'
+++

## Увод

Днес попаднахме на следната грешка: Операцията не може да бъде завършена (грешка 0x00000709), когато се опитах да осъществя достъп до споделен принтер от моята машина с Windows 11. Не го бях използвал от известно време, така че нямах представа откъде изведнъж дойде тази грешка.

## Първоначално отстраняване на неизправности

Първо погледнахме в посока на най-лесните решения:
- Включен ли е принтера?
- Включен ли е компютъра?
- Какви са правата на споделяне?
- и т.н.

Много бързо стигнахме до извода, че причината трябва да се търси на друго място. След кратко „ровене“ по форумите на Microsoft разбрахме за

## Причина за грешка на принтера 0x00000709

Причината е актуализацията на Windows 11 22H2. В тази версия е въведена нова настройка, наречена „Конфигуриране на настройките за RPC връзка“. Тази настройка вече може да бъде конфигурирана чрез редактора за групови правила, указва кой протокол и настройки да се използват за връзка с мрежов принтер.

Настройката по подразбиране в Windows 11 22H2 блокира намирането на мрежови принтери! Това ще премахне вашия мрежов принтер. И добавянето на принтер също не работи, просто получавате съобщение за грешка **0x00000bc4**.

## Решение за грешка 0x00000709

За да разрешим грешката „Операцията не може да бъде завършена (грешка 0x00000709)“, трябва да конфигурираме „Configure RPC Connection settings“ в настройките на груповите политики, така че „RPC over named pipes“ да е активен. Трудно? Не се безпокойте! Стъпките са обяснени по-долу:

1. Щракнете върху иконата на Windows 11, започнете да изписвате на клавиатурата „gpedit“ и щракнете върху резултата от търсенето „Edit group policy“.

[![](start-gpedit.png "{{< icon "link" >}}*фиг. 1*")](start-gpedit.png)

2. От списъка с категории разпънете последователно „Computer Configuration“ -> „Administrative Templates“ -> „Printers“.

[![](gpedit.png "{{< icon "link" >}}*фиг. 2*")](gpedit.png)

3. В дясната част намерете политиката „Configure RPC connection settings“ и щракнете два пъти върху нея. Ще се отвори нов прозорец, в който изберете „Enabled“ (разрешено) и в секцията „Protocol to use for outgoing RPC connections“ изберете от списъка „RPC over named pipes“.

[![](gpedit1.png "{{< icon "link" >}}*фиг. 3*")](gpedit1.png)

## Решение за „HOME“ версията на Windows

Тъй като в тази версия липсва редактор на политики, решението е да се използва редактора на регистрите, като се следват стъпките:

1. Щракнете върху иконата на Windows 11, започнете да изписвате на клавиатурата „regedit“ и щракнете върху резултата от търсенето „Registry Editor“.

[![](start-regedit.png "{{< icon "link" >}}*фиг. 4*")](start-regedit.png)

2. В „адресната лента“ въведете „Computer\HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT“ и натиснете „Enter“ на клавиатурата.
3. Проверете има ли секция „Printers“ под „Windows NT“, ако няма създайте такава като дадете десен клавиш върху „Windows NT“ и изберете „New -> Key“, след което изпишете „Printers“, за финал натиснете „Enter“.

[![](regedit.png "{{< icon "link" >}}*фиг. 5*")](regedit.png)

4. Аналогично на предната стъпка на „Printers“ трябва да има подпапка(key) „RPC“, ако няма - създайте такава.
5. Като краен резултат в адресната лента трябва да е изписано „Computer\HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers\RPC“
6. В дясната част трябва да се създадат 3 „DWORD (32-bit) Value“ стойности. Това става с десен клавиш -> „New“ -> „DWORD (32-bit) Value“ със следните имена:
   - „RpcOverNamedPipes“
   - „RPCOverTcp“
   - „RpcUseNamedPipeProtocol“
7. Кликнете на всяка два пъти и задайте стойност „1“.
8. Рестартирайте и сте готови!
